<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>升旗典禮_</title>
  <!--Bootstrap CSS-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">
  <link rel="icon" href="image/webicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="image/webicon.ico" type="image/x-icon" />
</head>
<style>
  * {
    margin: 0;
    padding: 0;
    /* overflow-x: hidden; */
  }

  .people-look{
    width: 100vw;
    /* height: 50vh; */
  }

  .pic-look{
    height: 25vh;/*跟flexbox-look一樣高*/
    object-fit: contain;
  }

  .flexbox-look{
    position: relative;
    margin-top: 5vh;
    height: 25vh;
    display: flex;
    justify-content: space-around;    
  }

  .enter-after-morning{
    display: flex;
    justify-content: flex-end;
    margin-bottom: 5%;
  }

  .enter-after-morning button{
    height: 5vh;
    width: 10vw;
    border: 2px solid black;
    background-color: #C3DD45;
    cursor: pointer;
  }

  .comic-bg{
    height: 100vh;
    width: 100vw;
    overflow: hidden;
    background-image: url(image/all-need-to-use/content-comic-bg.png);
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center center;
    position: fixed;
    z-index: -100;
  }

</style>

<body>
  <div id= 'rotate'>
    <div class="comic-bg"></div>
    <div class="container front-story">
      <div class="row">
        <div class="content col-12">
          <img src="image/morning-ing/morning-front.png" class="w-100">
        </div>
      </div>
    </div>
  
    <div class="visual-effect">
      <div class="content" >
        <div class="character-status">
          <!-- 現在用bg image做湘雲的反應，下面的是直接圖片 -->
          <div class="container d-flex justify-content-center align-items-center position-relative" style="height: 100vh;">
            <div class="col-2 position-absolute d-flex justify-content-center align-items-center position-relative" style="height: 100%;">
              <img src="image/morning-ing/character-status-1.png" class="w-100 character-status1 position-absolute">
              <img src="image/morning-ing/character-status-2.png" class="w-100 character-status2 position-absolute">
              <img src="image/morning-ing/character-status-3.png" class="w-100 character-status3 position-absolute">
            </div>
            <div class="people-look">
              <div class="flexbox-look look-horizontal-group-01">
                <img src="image/morning-ing/look-01.png" class="pic-look" style="position:absolute; margin-right: 70%;">
                <img src="image/morning-ing/look-02.png" class="pic-look" style="position:absolute; margin-top: 5%; margin-left: 70%;">
              </div>
              <div class="flexbox-look look-horizontal-group-02">
                <img src="image/morning-ing/look-03.png" class="pic-look" style="position:absolute; margin-right: 70%;">
                <img src="image/morning-ing/look-04.png" class="pic-look" style="position:absolute; margin-left: 70%;">
              </div>
              <div class="flexbox-look look-horizontal-group-03">
                <img src="image/morning-ing/look-05.png" class="pic-look" style="position:absolute; margin-top: -5%; margin-right: 70%;">
                <img src="image/morning-ing/look-06.png" class="pic-look" style="position:absolute; margin-left: 30%;">
                <img src="image/morning-ing/look-07.png" class="pic-look" style="position:absolute; margin-left: 70%;">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    <div class="container back-story">
      <div class="content col-12">
        <img src="image/morning-ing/morning-back.png" class="w-100">
      </div>
      <div class="enter-after-morning" style="display: flex; justify-content: flex-end; margin-bottom: 5%;">
        <a href="mobile-chapter2-page.html"><button>進入章節二</button></a>
      </div>
    </div>
  </div>


  <script src="	https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/studio-freight/lenis@1.0.27/bundled/lenis.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="./mobile-version/mobile-rotate.js"></script>
  <script src="./mobile-version/mobile-interact.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    function lookHorizontalGroupAnima(){
      console.log("pc animation");
      //stagger好像在純動畫裡面用比較好，在這邊功能會跟scrub相衝突
      const allPicLook = document.getElementsByClassName('pic-look');
      gsap.set(".character-status1", {autoAlpha: 1});
      gsap.set(".character-status2", {autoAlpha: 0});
      gsap.set(".character-status3", {autoAlpha: 0});

      gsap.set(allPicLook, {autoAlpha: 0})
      const tl = gsap.timeline({
        defaults: {
          ease:"expo",
        },
        scrollTrigger: {
          trigger: ".character-status",
          start: "top top",
          scrub: 1,
          end: "bottom top",
          pin: ".character-status",
          // markers: true
        }
      });

      tl
        //.to(allPicLook, {stagger: {each: 0.3}})
        .to(".look-horizontal-group-01 img:nth-child(1)", {autoAlpha: 1, x: 300})
        .to(".look-horizontal-group-01 img:nth-child(2)", {autoAlpha: 1, x: -250})
        .to(".character-status1", { autoAlpha: 0 })
        .to(".character-status2", { autoAlpha: 1 }, "-=0.3")
        .to(".look-horizontal-group-02 img:nth-child(1)", {autoAlpha: 1, x: 220}, "-=0.3")
        .to(".look-horizontal-group-02 img:nth-child(2)", {autoAlpha: 1, x: -310})
        .to(".look-horizontal-group-03 img:nth-child(1)", {autoAlpha: 1, x: 300})
        .to(".character-status2", { autoAlpha: 0 })
        .to(".character-status3", { autoAlpha: 1 }, "-=0.3")
        .to(".look-horizontal-group-03 img:nth-child(2)", {autoAlpha: 1, x: -80})
        .to(".look-horizontal-group-03 img:nth-child(3)", {autoAlpha: 1, x: -200})
    }

    function mobileLookHorizontalGroupAnima(){
      console.log("mobile animation");
      //stagger好像在純動畫裡面用比較好，在這邊功能會跟scrub相衝突
      const allPicLook = document.getElementsByClassName('pic-look');
      gsap.set(".character-status1", {autoAlpha: 1});
      gsap.set(".character-status2", {autoAlpha: 0});
      gsap.set(".character-status3", {autoAlpha: 0});

      gsap.set(allPicLook, {autoAlpha: 0})
      const tl = gsap.timeline({
        defaults: {
          ease:"expo",
        },
        scrollTrigger: {
          trigger: ".character-status",
          start: "top top",
          end: "bottom top",
          scrub: 1,
          pin: ".character-status",
          // markers: true
        }
      });

      tl
        //.to(allPicLook, {stagger: {each: 0.3}})
        .to(".look-horizontal-group-01 img:nth-child(1)", {autoAlpha: 1, x: 110})
        .to(".look-horizontal-group-01 img:nth-child(2)", {autoAlpha: 1, x: -80})
        .to(".character-status1", { autoAlpha: 0 })
        .to(".character-status2", { autoAlpha: 1 }, "-=0.3")
        .to(".look-horizontal-group-02 img:nth-child(1)", {autoAlpha: 1, x: 80}, "-=0.3")
        .to(".look-horizontal-group-02 img:nth-child(2)", {autoAlpha: 1, x: -100})
        .to(".look-horizontal-group-03 img:nth-child(1)", {autoAlpha: 1, x: 100})
        .to(".character-status2", { autoAlpha: 0 })
        .to(".character-status3", { autoAlpha: 1 }, "-=0.3")
        .to(".look-horizontal-group-03 img:nth-child(2)", {autoAlpha: 1, x: -60})
        .to(".look-horizontal-group-03 img:nth-child(3)", {autoAlpha: 1, x: -0})
    }
    
    function animationController(){
      let width = document.documentElement.clientWidth;
      let height = document.documentElement.clientHeight;
      let isMobile = window.matchMedia("(max-width: 768px)").matches;

      if(isMobile) {
        console.log("mobile");
        if (!isAnimationLoaded){
          mobileLookHorizontalGroupAnima();
          isAnimationLoaded = true;
        }
      }else{
        console.log("pc");
        if (!isAnimationLoaded){
          lookHorizontalGroupAnima();
          isAnimationLoaded = true;
        }
      }
    }

    let isAnimationLoaded = false; // 初始化動畫(未載入)
    
    const handleAnimation = () => {
      setTimeout(() => {
        animationController();
      }, 300);
    };

    window.addEventListener('resize', handleAnimation);
    window.addEventListener('load', animationController);

  </script>

</body>
</html>